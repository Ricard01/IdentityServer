@use 'sass:color';
@use 'sass:map';
@use '../custom/variables';
@use '../custom/badge' as *;
@use 'styles/custom/transitions';
@use '@angular/material' as mat;

@mixin theme($theme) {
  $is-dark-theme: map.get($theme, is-dark);
  $primary: map.get($theme, primary);
  $accent: map.get($theme, accent);
  $background: map.get($theme, background);
  $foreground: map.get($theme, foreground);

  .sidemenu {
    >.sidemenu-item {
      >a {
        color: #ffffff; // mat.get-color-from-palette($foreground, text);

        &:hover {
          background: mat.get-color-from-palette($background, hover);
        }
      }

      &.active {
        >a {
          // color:
          //   if($is-dark-theme,
          //     color.adjust(mat.get-color-from-palette($primary), $lightness: 25%),
          //     mat.get-color-from-palette($accent));
          background-color: if($is-dark-theme, rgba(mat.get-color-from-palette($primary), .25), transparent);

          &:hover {
            background: mat.get-color-from-palette($background, hover);
          }
        }
      }

      &.open {
        background: mat.get-color-from-palette($background, hover);
      }
    }

    &.sidemenu-sub {
      >.sidemenu-item {
        &.active {
          >a {
            background-color:rgba(mat.get-color-from-palette($primary), .25), transparent;

            &:hover {
              background: mat.get-color-from-palette($background, hover);
            }
          }
        }

        &.open {
          background: transparent;
        }
      }
    }
  }

  .sidemenu {
    width: variables.$sidenav-width;
    margin: 0;
    padding: 0;
    list-style: none;

    .sidemenu-item {
      display: block;
      height: auto;
      padding: 0;

      &.open {
        >.sidemenu {
          max-height: 2000px;
        }

        >.sidemenu-toggle>.menu-caret {
          transform: rotate(-180deg);
        }
      }
    }

    &.sidemenu-sub {
      max-height: 0;
      padding-top: 0;
      overflow: hidden;
      transform: translateZ(0) !important;
      transition: transitions.fast-out-slow(max-height);

      .sidemenu-item {
        border-left-width: 0;
      }
    }

    a {
      display: flex;
      flex-direction: row;
      align-items: center;
      height: 48px;
      padding: 0 16px;
      text-decoration: none;
      cursor: pointer;
    }

    .mat-icon.menu-icon {
      width: 18px;
      height: 18px;
      margin-right: 16px;
      font-size: 18px;
      line-height: 18px;

      [dir='rtl'] & {
        margin-right: auto;
        margin-left: 16px;
      }
    }

    .mat-icon.menu-caret {
      display: block;
      text-align: center;
      transition: transitions.fast-out-slow(transform);
    }

    .menu-name,
    .menu-label,
    .menu-badge {
      transition: transitions.swift-ease-out(opacity);
    }

    .menu-label,
    .menu-badge {
      @include badge();
    }

    .menu-badge {
      border-radius: 50rem;
    }

    &.level-0>li>a>.menu-name {
      margin-right: 5px;

      [dir='rtl'] & {
        margin-right: auto;
        margin-left: 5px;
      }
    }

    &.level-1>li>a {
      padding-left: 50px;

      [dir='rtl'] & {
        padding-right: 50px;
        padding-left: 16px;
      }
    }

    &.level-2>li>a {
      padding-left: 64px;

      [dir='rtl'] & {
        padding-right: 64px;
        padding-left: 16px;
      }
    }

    &.level-2 [class^='level-']>li>a {
      padding-left: 80px;

      [dir='rtl'] & {
        padding-right: 80px;
        padding-left: 16px;
      }
    }
  }

}
